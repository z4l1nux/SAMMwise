# ğŸŒ Sistema de InternacionalizaÃ§Ã£o (i18n)

Este documento descreve o sistema de internacionalizaÃ§Ã£o implementado no SAMMwise.

## ğŸ“‹ VisÃ£o Geral

O SAMMwise agora suporta mÃºltiplos idiomas usando `next-intl`, uma biblioteca moderna e eficiente para Next.js 14.

### Idiomas Suportados

- ğŸ‡ºğŸ‡¸ **InglÃªs (en)** - Idioma padrÃ£o
- ğŸ‡§ğŸ‡· **PortuguÃªs (pt)** - PortuguÃªs Brasileiro

## ğŸ—ï¸ Arquitetura

### Estrutura de Arquivos

```
sammwise/
â”œâ”€â”€ messages/
â”‚   â”œâ”€â”€ en.json              # TraduÃ§Ãµes em inglÃªs
â”‚   â””â”€â”€ pt.json              # TraduÃ§Ãµes em portuguÃªs
â”œâ”€â”€ i18n.js                  # ConfiguraÃ§Ã£o do i18n
â”œâ”€â”€ middleware.js            # Middleware para detecÃ§Ã£o de locale
â”œâ”€â”€ comps/
â”‚   â””â”€â”€ LanguageSwitcher.js  # Componente seletor de idioma
â””â”€â”€ styles/
    â””â”€â”€ LanguageSwitcher.module.css  # Estilos do seletor
```

### Componentes Principais

#### 1. Arquivos de TraduÃ§Ã£o (`messages/*.json`)

Estrutura hierÃ¡rquica de traduÃ§Ãµes:

```json
{
  "nav": {
    "home": "InÃ­cio",
    "assessment": "AvaliaÃ§Ã£o",
    "results": "Resultados"
  },
  "home": {
    "title": "SAMMwise",
    "description": "..."
  }
}
```

#### 2. ConfiguraÃ§Ã£o (`i18n.js`)

Define os locales suportados e carrega as mensagens:

```javascript
export const locales = ['en', 'pt'];
export const defaultLocale = 'en';
```

#### 3. Middleware (`middleware.js`)

Detecta automaticamente o idioma preferido do usuÃ¡rio e redireciona quando necessÃ¡rio.

#### 4. Language Switcher

Componente visual para trocar entre idiomas, localizado no navbar.

## ğŸ¯ Como Usar

### Em Componentes React

```javascript
import { useTranslations } from 'next-intl';

function MyComponent() {
  const t = useTranslations('home');
  
  return <h1>{t('title')}</h1>;
}
```

### Em PÃ¡ginas (Pages Router)

```javascript
// Para pÃ¡ginas estÃ¡ticas (SSG)
export async function getStaticProps({ locale }) {
  return {
    props: {
      messages: (await import(`../messages/${locale || 'en'}.json`)).default
    }
  };
}

// Para pÃ¡ginas dinÃ¢micas (SSR)
export async function getServerSideProps({ locale }) {
  return {
    props: {
      messages: (await import(`../messages/${locale || 'en'}.json`)).default
    }
  };
}
```

### TraduÃ§Ãµes Aninhadas

```javascript
// messages/en.json
{
  "features": {
    "feature1": "First feature",
    "feature2": "Second feature"
  }
}

// No componente
const t = useTranslations('features');
<p>{t('feature1')}</p>
```

### TraduÃ§Ãµes com ParÃ¢metros

```javascript
// messages/en.json
{
  "welcome": "Welcome, {name}!"
}

// No componente
<p>{t('welcome', { name: 'JoÃ£o' })}</p>
// Resultado: "Welcome, JoÃ£o!"
```

## ğŸ”§ Adicionando Novo Idioma

### 1. Criar arquivo de traduÃ§Ãµes

```bash
# Criar novo arquivo
touch messages/es.json  # Espanhol, por exemplo
```

### 2. Copiar estrutura e traduzir

```json
{
  "nav": {
    "home": "Inicio",
    "assessment": "EvaluaciÃ³n",
    "results": "Resultados",
    "about": "Acerca de"
  },
  ...
}
```

### 3. Atualizar configuraÃ§Ã£o

```javascript
// i18n.js
export const locales = ['en', 'pt', 'es'];  // Adicionar 'es'
```

### 4. Adicionar flag no LanguageSwitcher

```javascript
// comps/LanguageSwitcher.js
const languages = [
  { code: 'en', name: 'English', flag: 'ğŸ‡ºğŸ‡¸' },
  { code: 'pt', name: 'PortuguÃªs', flag: 'ğŸ‡§ğŸ‡·' },
  { code: 'es', name: 'EspaÃ±ol', flag: 'ğŸ‡ªğŸ‡¸' }  // Novo idioma
];
```

## ğŸ“ Estrutura de TraduÃ§Ãµes

### Namespaces Principais

| Namespace | DescriÃ§Ã£o | Uso |
|-----------|-----------|-----|
| `nav` | Menu de navegaÃ§Ã£o | Navbar links |
| `home` | PÃ¡gina inicial | ConteÃºdo principal |
| `assessment` | PÃ¡gina de avaliaÃ§Ã£o | Labels e botÃµes |
| `results` | PÃ¡gina de resultados | GrÃ¡ficos e labels |
| `footer` | RodapÃ© | Copyright e links |
| `meta` | SEO metadata | TÃ­tulos e descriÃ§Ãµes |
| `practices` | PrÃ¡ticas SAMM | Nomes das prÃ¡ticas |
| `buttons` | BotÃµes genÃ©ricos | AÃ§Ãµes comuns |
| `errors` | Mensagens de erro | Erros e avisos |

### Exemplo Completo

```javascript
// Componente Assessment
import { useTranslations } from 'next-intl';

function Assessment() {
  const t = useTranslations('assessment');
  const tMeta = useTranslations('meta');
  const tButtons = useTranslations('buttons');
  
  return (
    <>
      <Head>
        <title>{tMeta('assessmentTitle')}</title>
      </Head>
      <h1>{t('title')}</h1>
      <button>{tButtons('save')}</button>
    </>
  );
}
```

## ğŸ¨ Componente Language Switcher

### Features

- **Dropdown elegante** com animaÃ§Ãµes suaves
- **PersistÃªncia** no localStorage
- **Indicador visual** do idioma atual
- **Responsivo** para mobile e desktop
- **AcessÃ­vel** com ARIA labels

### CustomizaÃ§Ã£o

```css
/* styles/LanguageSwitcher.module.css */
.currentLanguage {
  /* Personalizar botÃ£o principal */
}

.dropdown {
  /* Personalizar dropdown */
}
```

## ğŸ” DetecÃ§Ã£o de Idioma

### Ordem de Prioridade

1. **localStorage** - PreferÃªncia salva do usuÃ¡rio
2. **URL** - Locale na URL (`/pt/about`)
3. **Browser** - Accept-Language header
4. **Default** - InglÃªs (fallback)

### PersistÃªncia

O idioma selecionado Ã© salvo automaticamente:

```javascript
// Salvo no localStorage
localStorage.setItem('locale', 'pt');

// Recuperado automaticamente
const savedLocale = localStorage.getItem('locale');
```

## ğŸ§ª Testando TraduÃ§Ãµes

### 1. Teste Manual

1. Abra a aplicaÃ§Ã£o
2. Clique no seletor de idioma no navbar
3. Selecione um idioma diferente
4. Navegue pelas pÃ¡ginas
5. Verifique se todas as traduÃ§Ãµes aparecem corretamente

### 2. Teste de Fallback

```javascript
// Se uma chave nÃ£o existir, mostra a chave
t('nonexistent.key')  // Exibe: "nonexistent.key"
```

### 3. VerificaÃ§Ã£o de Completude

```bash
# Script para verificar traduÃ§Ãµes faltantes
node scripts/check-translations.js
```

## ğŸ“Š Performance

### OtimizaÃ§Ãµes Implementadas

1. **Tree Shaking** - Apenas traduÃ§Ãµes usadas sÃ£o incluÃ­das
2. **Code Splitting** - TraduÃ§Ãµes carregadas sob demanda
3. **Static Generation** - PÃ¡ginas prÃ©-renderizadas com traduÃ§Ãµes
4. **No Runtime Overhead** - Zero JavaScript adicional no cliente

### Bundle Size

| Idioma | Tamanho | Impacto |
|--------|---------|---------|
| English | ~2KB | Baseline |
| PortuguÃªs | ~2.2KB | +200B |
| **Total** | ~4.2KB | MÃ­nimo |

## ğŸ› Troubleshooting

### Erro: "Missing message"

**Causa**: Chave de traduÃ§Ã£o nÃ£o encontrada

**SoluÃ§Ã£o**:
1. Verificar se a chave existe em `messages/*.json`
2. Verificar o namespace correto
3. Adicionar a traduÃ§Ã£o faltante

### Erro: "Locale not found"

**Causa**: Locale nÃ£o configurado

**SoluÃ§Ã£o**:
1. Adicionar locale em `i18n.js`
2. Criar arquivo `messages/{locale}.json`
3. Reiniciar o servidor

### TraduÃ§Ãµes nÃ£o aparecem

**Verificar**:
1. `getStaticProps` ou `getServerSideProps` estÃ¡ exportando messages
2. `NextIntlClientProvider` estÃ¡ envolvendo a aplicaÃ§Ã£o
3. `useTranslations` estÃ¡ sendo usado corretamente

## ğŸ“± Suporte Mobile

O seletor de idioma Ã© totalmente responsivo:

```css
@media (max-width: 768px) {
  .currentLanguage {
    padding: 8px 12px;
    font-size: 13px;
  }
}
```

## ğŸ” SeguranÃ§a

- Nenhuma informaÃ§Ã£o sensÃ­vel nas traduÃ§Ãµes
- ValidaÃ§Ã£o de locale no middleware
- SanitizaÃ§Ã£o de inputs do usuÃ¡rio

## ğŸš€ PrÃ³ximos Passos

### Features Planejadas

- [ ] Adicionar Espanhol (es)
- [ ] Adicionar FrancÃªs (fr)
- [ ] TraduÃ§Ã£o dinÃ¢mica de surveys completos
- [ ] RTL support (Ãrabe, Hebraico)
- [ ] Plural rules
- [ ] Date/Number formatting por locale
- [ ] Export de traduÃ§Ãµes para CSV
- [ ] Import de traduÃ§Ãµes de CSV
- [ ] Interface de gerenciamento de traduÃ§Ãµes

## ğŸ“š Recursos

- **next-intl**: https://next-intl-docs.vercel.app/
- **SAMM Translations**: Contribua com traduÃ§Ãµes oficiais do SAMM
- **ICU Message Format**: https://unicode-org.github.io/icu/userguide/format_parse/messages/

## ğŸ¤ Contribuindo com TraduÃ§Ãµes

### Como Contribuir

1. Fork o repositÃ³rio
2. Crie um novo arquivo `messages/{locale}.json`
3. Traduza todas as chaves mantendo a estrutura
4. Teste localmente
5. Envie um Pull Request

### Guidelines

- Manter tom profissional
- Respeitar terminologia SAMM oficial
- Testar em contexto real
- Incluir descriÃ§Ã£o das mudanÃ§as

## ğŸ“ Suporte

Problemas com i18n?
- ğŸ› Issues: [GitHub Issues](https://github.com/owaspsamm/sammwise/issues)
- ğŸ’¬ DiscussÃµes: [OWASP Slack](https://owasp.org/slack/invite)

---

**Ãšltima atualizaÃ§Ã£o**: Outubro 2025  
**VersÃ£o**: 2.0.0

